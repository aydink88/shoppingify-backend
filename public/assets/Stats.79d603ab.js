import{i as C,T as j}from"./index.ea15c364.js";import{r as o,j as n,c as p,S as f,a4 as x,Y as w,C as m}from"./vendor.f851533e.js";import{u as S}from"./useSafeDispatch.fdd96a09.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const y=async()=>{try{return(await C.get("/shoppinglist/topitems")).data}catch{throw"Fetching top items failed."}},A=async()=>{try{return(await C.get("/shoppinglist/topCategories")).data.map(e=>({...e,name:e._id}))}catch{throw"Fetching top categories failed."}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const M={status:"idle",data:null,error:null};function k(t){const e=o.exports.useRef({...M,...t}),[{status:i,data:d,error:s},g]=o.exports.useReducer((c,l)=>({...c,...l}),e.current),a=S(g),u=o.exports.useCallback(c=>a({data:c,status:"resolved"}),[a]),r=o.exports.useCallback(c=>a({error:c,status:"rejected"}),[a]),h=o.exports.useCallback(()=>a(e.current),[a]),T=o.exports.useCallback(c=>{if(!c||!c.then)throw new Error("The argument passed to useAsync().run must be a promise. Maybe a function that's passed isn't returning anything?");return a({status:"pending"}),c.then(l=>(u(l),l),l=>(r(l),Promise.reject(l)))},[a,u,r]);return{isIdle:i==="idle",isLoading:i==="pending",isError:i==="rejected",isSuccess:i==="resolved",setData:u,setError:r,error:s,status:i,data:d,run:T,reset:h}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function b({title:t,variant:e,fetchData:i,howMany:d=3}){const{data:s,run:g}=k([]);o.exports.useEffect(()=>{g(i()).catch()},[]);const a=o.exports.useMemo(()=>{let r=0;if(s!=null&&s.length)for(const h of s)r+=h.amount;return r},[s]),u=o.exports.useMemo(()=>s!=null&&s.length?s.slice(0,d):[],[s]);return!s||!a?n(j,{}):p("div",{className:"p-2 m-2",children:[n("h3",{children:t}),u.map(r=>{const h=r.amount*100/a;return p(f,{className:"my-3","data-testid":"topbarsmember",children:[p(f,{direction:"horizontal",className:"justify-content-between",children:[n("span",{children:r.name}),p("span",{children:[h.toFixed(0),"%"]})]}),n(x,{variant:e,now:h,label:`${h}%`,visuallyHidden:!0})]},r._id)})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function I(){return n(f,{children:p(w,{children:[n(m,{xs:12,sm:6,md:12,lg:6,children:n(b,{title:"Top Items",fetchData:y})}),n(m,{xs:12,sm:6,md:12,lg:6,children:n(b,{title:"Top Categories",fetchData:A,variant:"info"})})]})})}export{I as default};
